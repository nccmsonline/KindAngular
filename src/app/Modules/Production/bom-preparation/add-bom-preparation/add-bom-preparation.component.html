<div class="preloader" style="display: none;">
    <div class="lds-ripple">
      <div class="lds-pos"></div>
      <div class="lds-pos"></div>
    </div>
  </div>
  <div id="main-wrapper" data-theme="light" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
    data-sidebar-position="fixed" data-header-position="fixed" data-boxed-layout="full">
    <app-header></app-header>
    <app-sidebar></app-sidebar>
  
    <div class="page-wrapper">
      <div class="container-fluid" style="background:#dcdcdc;">
  
        <form  [formGroup]="BOMentry" novalidate>
          <div class="example-loading-shade" *ngIf="isLoadingResults ">
            <mat-spinner [diameter]="40" *ngIf="isLoadingResults"></mat-spinner>
          </div>
          <div class="row">
            <div class="col-md-12">
              <div class="card" style="border-top: 2px solid #0e43af;box-shadow:0 1px 3px rgba(0,0,0,.3);"
                (click)="dropdownHide()">
                <div class="card-body border-bottom py-2">
                  <div class="d-md-flex align-items-center justify-content-between">
                    <div class="d-flex">
                      <a [routerLink]="['/bom-preparation']" class="btn btn-sm rounded btn-warning mr-3"
                        title="Back to Orders"><i class="mdi mdi-keyboard-backspace"></i></a>
                      <h4 class="card-title m-0">{{'bompreparation'| translate}}</h4>
                    </div>
  
                  </div>
                </div>
                <div class="d-flex- row">
                  <div class="col-md-12 tab-content m-t-10" id="pills-tabContent">
                    <div class="card-body indent-entry px-0 py-2">
                      <div class="form-inline" *ngIf="!custbom">
                        <div class="form-group col-md-12 mb-1">
                          <label class="col-md-2 text-right error-control-label required"
                            for="inputEmail4">{{'diename' | translate}}</label>
                          <div class="col-md-10">
                            <input [(ngModel)]="newData.DIENAME" [ngModelOptions]="{standalone: true}"
                              (keyup)="searchTermProductDesc($event.target.value, newData)"
                              [value]="newData.DIENAME || ''" autocomplete="off"
                              class="w-100 form-control error-border form-control-sm">
                            <div *ngIf="arrayItemProductDesc != ''" class="search-list-header">
                             
                              <table id="selectedValue" class="table table-condensed table-striped table-hover">
                                <tr class="ui-menu-item" role="menuitem">
                                  <th>{{'diename' | translate}}</th>
                                  <th>{{'dieid' | translate}}</th>
                                </tr>
                              
                                <tr class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                  (click)="onChangeOldCode(result, newData)">
                                  <td>{{ result.DIENAME }}</td>
                                  <td>{{ result.DIEID }}</td>
                                </tr>
                              </table>
                              <!-- </div>
                            </div> -->
                            </div>
  
                          </div>
                        </div>
                        <div class="form-group col-md-12 mb-1">
                          <!-- <label class="col-md-2 text-right" for="inputEmail4">{{'oldcode' | translate}}</label>i -->
                          <!-- <div class="col-md-2"> -->
                            <!-- <input [(ngModel)]="newData.oldcode" [ngModelOptions]="{standalone: true}"
                              (keyup)="searchTermOldCode($event.target.value, newData)" [value]="newData.oldcode || ''"
                              autocomplete="off" class="w-100 form-control error-border form-control-sm">
                            <div *ngIf="arrayItemOldCode != ''" class="search-list-header">
                              <ul id="selectedValue">
                                <li class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                  (click)="onChangeOldCode(result, newData)">
                                  <a> {{ result.oldcode }} </a>
                                </li>
                              </ul>
                            </div> -->
                          <!-- </div> -->
                          <label class="col-md-2 text-right  " for="inputEmail4">{{'plannedstrokes' | translate}}</label>
                          <div class="col-md-2">
  
                            <input [(ngModel)]="newData.PLANNEDSTROKES" [ngModelOptions]="{standalone: true}"
                            
                              [value]="newData.PLANNEDSTROKES || ''" autocomplete="off"
                              class="w-100 form-control error-border form-control-sm readonly-disable" readonly>
                            <!-- <div *ngIf="arrayItemProductCode != ''" class="search-list-header">
                              <ul id="selectedValue">
                                <li class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                  (click)="onChangeOldCode(result, newData)">
                                  <a> {{ result.DIEID }} </a>
                                </li>
                              </ul>
                            </div> -->
                          </div>
  
                          <label class="col-md-2 text-right" for="inputPassword4">{{'party' | translate}}</label>
                          <div class="col-md-6">
                            <input type="text" class="form-control error-border form-control-sm readonly-disable"
                              name="PARTYNAME" [(ngModel)]="newData.PARTYNAME" [ngModelOptions]="{standalone: true}" readonly>
                          </div>
                        </div>
                        <div class="form-group col-md-12 mb-2">
                          <label class="col-md-2 text-right" for="inputPassword4">{{'strokesmade' | translate}}</label>
                          <div class="col-md-2">
                            <input type="text" class="form-control error-border form-control-sm  readonly-disable" name="STROKESMADE"
                              [(ngModel)]="newData.STROKESMADE" [ngModelOptions]="{standalone: true}" maxlength="100" readonly>
                          </div>
  
                          <div class="form-group col-md-4 ">
                            <label class="col-md-6 text-right  error-control-label required" for="inputPassword4">Batch
                              Size</label>
                            <div class="col-md-6">
                              <input type="text" class="form-control error-border form-control-sm" name="BATCHSIZE"
                                [(ngModel)]="newData.BATCHSIZE" [ngModelOptions]="{standalone: true}"
                                (keyup)="batchSizeLength($event.target.value)"
                                oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');">
                            </div>
                          </div>
                          <!-- <div class="form-group col-md-4 mt-2" *ngIf="!custbom">
                            <label class="col-md-10 text-right">{{'makeacopyofanexistingbom' | translate}}</label>
                            <div class="col-md-2">
                              <mat-checkbox [(ngModel)]="newData.iscopy" [ngModelOptions]="{standalone: true}"
                                (change)="iscopy($event)"></mat-checkbox>
                            </div>
                          </div> -->
                        </div>
                        <!-- <div class="form-group col-md-12" *ngIf="showaftercheckcopy">
                          <div class="form-group col-md-6 mt-2">
                            <label class="col-md-4 text-right"
                              for="inputEmail4">{{'selectproductorSubAssytoviewedit' | translate}}</label>
                            <div class="col-md-8">
                              <input [(ngModel)]="bomData.ITEMNAME" [ngModelOptions]="{standalone: true}"
                                (keyup)="searchTermBOM($event.target.value, bomData)" [value]="bomData.ITEMNAME || ''"
                                autocomplete="off" class="w-100 form-control error-border form-control-sm">
                              <div *ngIf="arraystandarBOM != ''" class="search-list-header">
                                <table id="selectedValue" class="table table-condensed table-striped table-hover">
                                  <tr class="ui-menu-item" role="menuitem">
                                    <th>{{'bom' | translate}}</th>
                                  <th>{{'VERSION' | translate}}</th>
                                  </tr>
                                  <tr class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistbom"
                                    (click)="onChangebom(result, bomData)">
                                    <td>{{ result.ITEMNAME }}</td>
                                    <td>{{ result.VERSION }}</td>
                                  </tr>
                                </table>
                              </div>
                            </div>
                          </div>
                          <div class="form-group col-md-4 mt-2">
                            <button class="btn btn-sm rounded btn-info waves-effect waves-light" (click)="viewbom()">View
                              {{'bom' | translate}}</button>
                          </div>
                        </div> -->
                        <!-- <div class="form-group col-md-12 mb-1" *ngIf="showaftercopy">
                          <label class="col-md-4 text-right"
                            for="inputEmail4">{{'selectproductorSubAssytoviewedit' | translate}}</label>
                          <div class="col-md-6">
                            <ngx-select
                              class="ngx-custom-select-dropdown ngx-custom-category-select ngx-custom-select-dropdown-text-wrap"
                              [allowClear]="true" [items]="subitemlistget" optionValueField="itemid"
                              optionTextField="itemname" (selectionChanges)="subitemChange($event)">
                            </ngx-select>
                          </div>
                          <div class="form-group mr-1">
                            <label>&nbsp;</label>&nbsp;<span></span>
                            <button class="btn btn-sm rounded btn-info waves-effect waves-light"
                              (click)="applyfilter()"><i class="fa fa-filter"></i></button>
                          </div>
                        </div> -->
  
                        <div class="form-group col-md-12 mb-1">
                            <label class="col-md-2 text-right">{{'remarks' | translate}}</label>
                            <div class="col-md-10">
                            <textarea autosize type="text" style="height: 40px;" class="form-control form-control-sm w-100" name="REMARKS" [(ngModel)]="newData.REMARKS" [ngModelOptions]="{standalone: true}"></textarea>
                          </div>
                        </div>
                      </div>
                      <div class="form-inline" *ngIf="custbom">
                        <div class="form-group col-md-12 mb-1">
                          <label class="col-md-2 text-right p-0"
                            for="inputEmail4">{{'customizebomforoano' | translate}}</label>
                          <div class="col-md-3">
                            <ng-select class="form-control custom-slect-box error-border form-control-sm w-100 "
                              [(ngModel)]='bomData.oaid' name="oaid" [ngModelOptions]="{standalone: true}"
                              (change)="onOAChange($event)" [items]="orderlist" bindLabel="oano" bindValue="oaid"
                              placeholder="Select O.A.">
                              <ng-template ng-header-tmp>
                                <table>
                                  <tr>
                                    <th style="width:100px;">
                                      {{'oano' | translate}}
                                    </th>
                                    <th style="width:70%;">
                                      {{'oanodt' | translate}}
                                    </th>
                                  </tr>
                                  <ng-template ng-option-tmp let-item="item">
                                    <tr>
                                      <td style="width:100px;">
                                        {{item.oano}}
                                      </td>
                                      <td style="width:70%;">
                                        {{item.oadate  | date:'dd/MM/yyyy'}}
                                      </td>
                                    </tr>
                                  </ng-template>
                                </table>
                              </ng-template>
                            </ng-select>
                          </div>
                          <div class="col-md-4 ml-1">
                            <ngx-select
                              class="ngx-custom-select-dropdown ngx-custom-category-select ngx-custom-select-dropdown-text-wrap"
                              [allowClear]="true" [items]="itemsforOrderNo" optionValueField="itemid"
                              optionTextField="itemname">
                            </ngx-select>
                          </div>
                        </div>
                        <div class="form-group col-md-12 mb-1">
                          <label class="col-md-2 text-right p-0"
                            for="inputEmail4">{{'createbomforselecteditem' | translate}}</label>
                          <mat-radio-group mat-radio-group class=" ml-3 mat-radio-label d-flex align-items-center"
                            name="checkbom" [(ngModel)]='bomData.checkbom' [ngModelOptions]="{standalone: true}"
                            (change)="changetype($event)" aria-label="Select an option">
                            <mat-radio-button value="S" checked>{{'standardbom' | translate}}
                            </mat-radio-button>
                            &nbsp;&nbsp;
                            <mat-radio-button value="C">{{'custtomizebom' | translate}}
                            </mat-radio-button>
                          </mat-radio-group>
                          <div class="col-md-4 ml-4" *ngIf="showstandard">
                            <input [(ngModel)]="bomData.ITEMNAME" [ngModelOptions]="{standalone: true}"
                              (keyup)="searchTermBOM($event.target.value, bomData)" [value]="bomData.ITEMNAME || ''"
                              autocomplete="off" class="w-100 form-control error-border form-control-sm">
                            <div *ngIf="arraystandarBOM != ''" class="search-list-header">
                              <table id="selectedValue" class="table table-condensed table-striped table-hover">
                                <tr class="ui-menu-item" role="menuitem">
                                  <th>{{'bom' | translate}}</th>
                                  <th>{{'VERSION' | translate}}</th>
                                </tr>
                                <tr class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistbom"
                                  (click)="onChangestandardbom(result, bomData)">
                                  <td>{{ result.ITEMNAME }}</td>
                                  <td>{{ result.VERSION }}</td>
                                </tr>
                              </table>
                            </div>
                          </div>
                          <div class="col-md-4" *ngIf="!showstandard">
                            <input [(ngModel)]="bomData.customername" [ngModelOptions]="{standalone: true}"
                              (keyup)="searchTermCustBOM($event.target.value, bomData)"
                              [value]="bomData.customername || ''" autocomplete="off"
                              class="w-100 form-control error-border form-control-sm">
                            <div *ngIf="arraycustomBOM != ''" class="search-list-header">
                              <table id="selectedValue" class="table table-condensed table-striped table-hover">
                                <tr class="ui-menu-item" role="menuitem">
                                  <th>{{'party' | translate}}</th>
                                  <th>{{'oano' | translate}}</th>
                                  <th>{{'oanodt' | translate}}</th>
                                </tr>
                                <tr class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistcustbom"
                                  (click)="onChangeCustBom(result, bomData)">
                                  <td>{{ result.customername }}</td>
                                  <td>{{ result.oano }}</td>
                                  <td>{{ result.oadate }}</td>
                                </tr>
                              </table>
                            </div>
                          </div>
                          <div class="col-md-2">
                            <button  type="button" class="btn btn-sm btn-info rounded"
                            >{{'link' | translate}}</button>
  
                          </div>
                        </div>
  
                      </div>
                      <h4 style="padding-top:30px; margin-left: 5px;">{{'itemdetails' | translate}}</h4>
                      <div class="table-scroll mx-1">
  
                        <div class="card-body border-top supplier-master px-0 py-2">
  
                          <table class="table table-striped custom-table tr th">
                            <thead>
                              <tr style="background-color: #666666; color: #ffffff;">
                                <!-- <th scope="col" style="width:15%;min-width: 100px;">{{'oldcode' | translate}}</th> -->
                                <th scope="col" style="width:35%;min-width: 100px;">{{'itemdescription' | translate}}</th>
                                <th scope="col" style="width:15%;min-width: 100px;">{{'itemcode' | translate}}</th>
                                <th scope="col" style="width:10%;min-width: 50px;">{{'mfgr/BRAND' | translate}}</th>
                                <th scope="col" style="width:6%;min-width: 50px;">{{'issunit' | translate}}</th>
                                <th scope="col" style="width:8%;min-width: 50px;text-align: right;">
                                  {{'quantity' | translate}}</th>
  
                                <!-- <th scope="col" style="width:8%;min-width: 50px;text-align: right;">{{'qty/batch' | translate}}</th> -->
                                <th scope="col" style="width:8%;min-width: 50px;text-align: right;">
                                  {{'qty/perunit' | translate}}</th>
  
                                <th scope="col" style="width:6%;min-width: 50px;text-align: right;">
                                  {{'tolerance' | translate}}</th>
                                <th scope="col" style="width:8%;min-width: 50px;text-align: right;">
                                  {{'wastagepercent' | translate}}</th>
                                <th scope="col" style="width:8%;min-width: 50px;text-align: right;">
                                  {{'wastageqty' | translate}}</th>
  
                                <!-- <th scope="col" style="width:8%;min-width: 50px;text-align: right;">
                                  {{'length' | translate}}</th>
                                <th scope="col" style="width:8%;min-width: 50px;text-align: right;">
                                  {{'width' | translate}}</th>
                                <th scope="col" style="width:8%;min-width: 100px;text-align: right;">
                                  {{'rmitem' | translate}}</th>
                                <th scope="col" style="width:8%;min-width: 50px;text-align: right;">
                                  {{'wtinkg' | translate}}</th> -->
                                <th scope="col" style="width:4%;text-align: center;">{{'action' | translate}}</th>
                              </tr>
                            </thead>
                            <tbody class="font-sm">

                              <tr>
                                <!-- <td> -->
                                  <!-- <ngx-select class="ngx-custom-select-dropdown  ngx-custom-select-dropdown-text-wrap"
                              [(ngModel)]='newItem.cid' [ngModelOptions]="{standalone: true}" name="cid"
                              [allowClear]="true" [items]="itemlistget" optionValueField="id" optionTextField="oldcode"
                              (remove)="removeitem()" (ngModelChange)="onChangeOfItemCode($event, newItem)">
                            </ngx-select> -->
                                  <!-- <input #oldcodefocus (keyup)="searchNewTermOldCode($event.target.value, newItem)"
                                    name="itemid" [(ngModel)]='newItem.oldcode' [ngModelOptions]="{standalone: true}"
                                    [value]="newItem.oldcode || ''" autocomplete="off"
                                    class="w-100 form-control error-border form-control-sm">
                                  <div *ngIf="arrayNewItemOldCode != ''" class="search-list">
                                    <ul id="selectedValue" class="custom-customer-order-list">
                                      <li class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                        (click)="onChangeOfOldCode(result, newItem)">
                                        <a> {{ result.oldcode }} </a>
                                      </li>
                                    </ul>
                                  </div>
                                </td> -->
  
                                <td>
                                  <!-- <ngx-select class="ngx-custom-select-dropdown  ngx-custom-select-dropdown-text-wrap"
                              [(ngModel)]='newItem.cid' [ngModelOptions]="{standalone: true}" name="cid"
                              [allowClear]="true" [items]="itemlistget" optionValueField="id" optionTextField="itemname"
                              (ngModelChange)="onChangeOfItemCode($event, newItem)">
                            </ngx-select> -->
                                  <input (keyup)="searchNewTermItemDesc($event.target.value, newItem)" name="itemid"
                                    [(ngModel)]='newItem.ITEMNAME' [ngModelOptions]="{standalone: true}"
                                    [value]="newItem.ITEMNAME || ''" autocomplete="off"
                                    class="w-100 form-control error-border form-control-sm">
                                  <div *ngIf="arrayNewItemDesc != ''" class="search-list-header">
  
                                    <table id="selectedValue" class="table table-condensed table-striped table-hover">
                                      <tr class="ui-menu-item" role="menuitem">
                                        <th>{{'itemname' | translate}}</th>
                                        <th>{{'itemcode' |translate}}</th>
                                      </tr>
                                      <tr class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                        (click)="onChangeOfOldCode(result, newItem)">
                                        <td>{{ result.ITEMNAME }}</td>
                                        <td>{{ result.ITEMCODE }}</td>
                                      </tr>
                                    </table>
                                  </div>
                                </td>
                                <td>
                                  <input (keyup)="searchNewTermItemCode($event.target.value, newItem)" name="itemid"
                                    [(ngModel)]='newItem.ITEMCODE' [ngModelOptions]="{standalone: true}"
                                    [value]="newItem.ITEMCODE || ''" autocomplete="off"
                                    class="w-100 form-control error-border form-control-sm">
                                  <div *ngIf="arrayNewItemCode != ''" class="search-list">
                                    <ul id="selectedValue" class="custom-customer-order-list">
                                      <li class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                        (click)="onChangeOfOldCode(result, newItem)">
                                        <a> {{ result.ITEMCODE }} </a>
                                      </li>
                                    </ul>
                                  </div>
                                  <!-- <input type="text" class="form-control w-100" [(ngModel)]='newItem.ITEMCODE' [readonly]="true"
                              [ngModelOptions]="{standalone: true}"> -->
                                </td>
                                <td>
                                  <!-- <select class="select2 form-control form-control-sm custom-select"
                              [(ngModel)]='newItem.BRANDID' (ngModelChange)="onChangeOfBrand($event,newItem)"
                              [ngModelOptions]="{standalone: true}">
                              <option *ngFor="let brandlist of brandlistget" [value]='brandlist.id'
                                value='{{brandlist.name}}'>{{brandlist.name}}</option>
                            </select> -->
                                  <ngx-select class="ngx-custom-select-dropdown ngx-custom-select-dropdown-text-wrap"
                                    [ngModelOptions]="{standalone: true}" [allowClear]="true"
                                    [(ngModel)]="newItem.BRANDID" [items]="brandlistget" name="BRANDID"
                                    optionValueField="ID" optionTextField="NAME"
                                    (select)="onChangeOfBrand($event, newItem)">
                                  </ngx-select>
                                </td>
  
                                <td>
                                  <input type="text" class="form-control w-100 readonly-disable"
                                    [(ngModel)]='newItem.UNIT' [readonly]="true"
                                    [ngModelOptions]="{standalone: true}">
                                </td>
  
                                <td><input type="text" class="form-control w-100" (keyup)="calculateWastage(newItem)"
                                    [(ngModel)]="newItem.QTY" [ngModelOptions]="{standalone: true}"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
  
                                <!-- <td><input type="text" class="form-control w-100" (keyup)="calculateQuantity(newItem)"
                            [(ngModel)]="newItem.quantitybatch" [ngModelOptions]="{standalone: true}"
                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                            style="text-align: right;"></td> -->
  
                                <td class="text-right">{{newItem.quantityperunit}}</td>
  
                                <td><input type="text" class="form-control w-100" [(ngModel)]="newItem.TOLERANCE"
                                    [ngModelOptions]="{standalone: true}"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
  
                                <td><input type="text" class="form-control w-100" (change)="calculateWastage(newItem)"
                                    [(ngModel)]="newItem.WASTAGEPERCENT" [ngModelOptions]="{standalone: true}"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;" (keyup.enter)="additem(newItem)"></td>
  
                                <td><input type="text" class="form-control w-100 readonly-disable"
                                    (change)="calculateWastagePercent(newItem)" [(ngModel)]="newItem.WASTAGEQTY"
                                    [ngModelOptions]="{standalone: true}" [readonly]="true"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
  
                                <!-- <td><input type="text" class="form-control w-100 {{newItem.lengthDisableClass}}"
                                    [(ngModel)]="newItem.LENGTH" [ngModelOptions]="{standalone: true}"
                                    [readonly]="newItem.lengthReadOnly"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
  
                                <td><input type="text" class="form-control w-100 {{newItem.widthDisableClass}}"
                                    [(ngModel)]="newItem.WIDTH" [ngModelOptions]="{standalone: true}"
                                    [readonly]="newItem.widthReadOnly"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
  
                                <td>
                                  <input (keyup)="searchRmTypeDesc($event.target.value, newItem)" name="rmtypeid"
                                    [(ngModel)]='newItem.rmtypedesc' [ngModelOptions]="{standalone: true}"
                                    [value]="newItem.rmtypedesc || ''" autocomplete="off"
                                    class="w-100 form-control error-border form-control-sm {{newItem.readonlyRMTypeClass}}"
                                    [readonly]="newItem.readonlyRMType">
                                  <div *ngIf="searchRMDesc != ''" class="search-list-header" style="right: 0;">
  
                                    <table id="selectedValue" class="table table-condensed table-striped table-hover">
                                      <tr class="ui-menu-item" role="menuitem">
                                        <th>{{'itemname' | translate}}</th>
                                        <th>{{'itemcode' | translate}}</th>
                                      </tr>
                                      <tr class="ui-menu-item" role="menuitem" *ngFor="let result of rmtypeList"
                                        (click)="onChangeRMType(result, newItem)">
                                        <td>{{ result.ITEMNAME }}</td>
                                        <td>{{ result.ITEMCODE }}</td>
                                      </tr>
                                    </table>
                                  </div>
                                </td>
  
                                <td><input type="text" class="form-control w-100" [(ngModel)]='newItem.COMPONENTWT'
                                    [ngModelOptions]="{standalone: true}"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td> -->
  
                                <td style="width:60px;text-align: center;">
                                  <i (click)="additem(newItem)" class="fas fa-plus {{canCreateCommonClass}}"></i>
                                </td>
                              </tr>
                              <tr *ngFor="let item of items ; let i = index">
  
                                <!-- <td *ngIf="item.ID === editItemID"> -->
  
                                  <!-- <ngx-select
                              class="ngx-custom-select-dropdown ngx-custom-select-dropdown-text-wrap custom-item-dropdown"
                              [(ngModel)]='item.cid' [ngModelOptions]="{standalone: true}" name="cid" [allowClear]="true"
                              [items]="itemlistget" optionValueField="id" optionTextField="oldcode"
                              (remove)="removeitem()" (ngModelChange)="onChangeOfItemCode($event, item)">
                            </ngx-select> -->
                                  <!-- <input (keyup)="searchEditOldCode($event.target.value, item)" name="itemid"
                                    [(ngModel)]='item.oldcode' [ngModelOptions]="{standalone: true}"
                                    [value]="item.oldcode || ''" autocomplete="off"
                                    class="w-100 form-control error-border form-control-sm">
                                  <div *ngIf="arrayEditItemOldCode != ''" class="search-list">
                                    <ul id="selectedValue" class="custom-customer-order-list">
                                      <li class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                        (click)="onChangeOfOldCode(result, item)">
                                        <a> {{ result.oldcode }} </a>
                                      </li>
                                    </ul>
                                  </div>
                                </td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)">{{item.oldcode}}</td> -->
  
                                <td *ngIf="item.ID === editItemID">
                                  <!-- <ngx-select
                              class="ngx-custom-select-dropdown ngx-custom-select-dropdown-text-wrap custom-item-dropdown"
                              [(ngModel)]='item.cid' [ngModelOptions]="{standalone: true}" name="cid" [allowClear]="true"
                              [items]="itemlistget" optionValueField="id" optionTextField="itemname"
                              (ngModelChange)="onChangeOfItemCode($event, item)">
                            </ngx-select> -->
                                  <input matTooltip="{{ item.ITEMNAME }}"
                                    (keyup)="searchEditTermItemDesc($event.target.value, item)" name="itemid"
                                    [(ngModel)]='item.ITEMNAME' [ngModelOptions]="{standalone: true}"
                                    [value]="item.ITEMNAME || ''" autocomplete="off"
                                    class="w-100 form-control error-border form-control-sm">
                                  <div *ngIf="arrayEditItemDesc != ''" class="search-list-header">
                                    <!-- <ul id="selectedValue" class="custom-customer-order-list">
                                <li class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget" (click)="onChangeOfOldCode(result, item)">
                                  <a> {{ result.ITEMNAME }} {{ result.oldcode }} {{ result.ITEMCODE }} </a>
                                </li>
                              </ul> -->
                                    <table id="selectedValue" class="table table-condensed table-striped table-hover">
                                      <tr class="ui-menu-item" role="menuitem">
                                        <th>{{'itemname' | translate}}</th>
                                        <th>{{'itemcode' | translate}}</th>
                                      </tr>
                                      <tr class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                        (click)="onChangeOfOldCode(result, item)">
                                        <td>{{ result.ITEMNAME }}</td>
                                        <td>{{ result.ITEMCODE }}</td>
                                      </tr>
                                    </table>
                                  </div>
  
                                </td>
                                <td matTooltip="{{ item.ITEMNAME }}" *ngIf="item.ID !== editItemID"
                                  (dblclick)="editItem(item.ID)">{{item.ITEMNAME}}</td>
                                <td *ngIf="item.ID === editItemID">
  
                                  <input (keyup)="searchEditItemCode($event.target.value, item)" name="itemid"
                                    [(ngModel)]='item.ITEMCODE' [ngModelOptions]="{standalone: true}"
                                    [value]="item.ITEMCODE || ''" autocomplete="off"
                                    class="w-100 form-control error-border form-control-sm">
                                  <div *ngIf="arrayEditItemCode != ''" class="search-list">
                                    <ul id="selectedValue" class="custom-customer-order-list">
                                      <li class="ui-menu-item" role="menuitem" *ngFor="let result of itemlistget"
                                        (click)="onChangeOfOldCode(result, item)">
                                        <a> {{ result.ITEMCODE }} </a>
                                      </li>
                                    </ul>
                                  </div>
                                  <!-- <input type="text" class="select2 form-control form-control-sm custom-select"
                              [(ngModel)]='item.ITEMCODE' [readonly]="true" [ngModelOptions]="{standalone: true}"> -->
  
                                </td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)">{{item.ITEMCODE}}</td>
  
                                <td *ngIf="item.ID === editItemID">
                                  <!-- <select class="form-control form-control-sm" [(ngModel)]='item.BRANDID'
                              (ngModelChange)="onChangeOfBrand($event, item)" [ngModelOptions]="{standalone: true}">
                              <option *ngFor="let brandlist of brandlistget" [value]='brandlist.id'
                                value='{{brandlist.id}}'>{{brandlist.name}}</option>
                            </select> -->
                                  <ngx-select class="ngx-custom-select-dropdown ngx-custom-select-dropdown-text-wrap"
                                    [ngModelOptions]="{standalone: true}" [allowClear]="true" [(ngModel)]="item.BRANDID"
                                    [items]="brandlistget" name="BRANDID" optionValueField="ID" optionTextField="NAME"
                                    (select)="onChangeOfBrand($event, item)">
                                  </ngx-select>
                                </td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)">{{item.BRAND}}</td>
                                <td *ngIf="item.ID === editItemID">
                                  <input type="text"
                                    class="select2 form-control form-control-sm custom-select readonly-disable"
                                    [(ngModel)]='item.UNIT' [readonly]="true"
                                    [ngModelOptions]="{standalone: true}">
                                </td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)">{{item.UNIT}}
                                </td>
  
                                <td *ngIf="item.ID === editItemID"><input type="text" (keyup)="calculateWastage(item)"
                                    class="form-control w-100" [(ngModel)]='item.QTY'
                                    [ngModelOptions]="{standalone: true}"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)"
                                  style="text-align: right;">
                                  {{item.QTY | number : '1.3-3'}}</td>
  
                                <!-- <td *ngIf="item.ID === editItemID"><input type="text"  (keyup)="calculateQuantity(item)"
                            class="form-control w-100" [(ngModel)]='item.quantitybatch' [ngModelOptions]="{standalone: true}"
                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                            style="text-align: right;"></td>
                          <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)" style="text-align: right;">
                            {{item.quantitybatch | number : '1.3-3'}}</td> -->
                                <td (dblclick)="editItem(item.ID)" style="text-align: right;" class="text-right">
                                  {{item.quantityperunit | number : '1.3-3'}}</td>
  
                                <td *ngIf="item.ID === editItemID"><input type="text" class="form-control w-100"
                                    [(ngModel)]='item.TOLERANCE' [ngModelOptions]="{standalone: true}"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)"
                                  style="text-align: right;">
                                  {{item.TOLERANCE | number : '1.3-3'}}</td>
  
                                <td *ngIf="item.ID === editItemID"><input type="text" class="form-control w-100"
                                    (change)="calculateWastage(item)" [(ngModel)]='item.WASTAGEPERCENT'
                                    [ngModelOptions]="{standalone: true}" (keyup.enter)="updateItem(item)"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)"
                                  style="text-align: right;">
                                  {{item.WASTAGEPERCENT | number : '1.3-3'}}</td>
  
                                <td *ngIf="item.ID === editItemID"><input type="text"
                                    class="form-control w-100 readonly-disable text-right"
                                    (change)="calculateWastagePercent(item)" [(ngModel)]='item.WASTAGEQTY'
                                    [ngModelOptions]="{standalone: true}" [readonly]="true"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)"
                                  style="text-align: right;">
                                  {{item.WASTAGEQTY | number : '1.3-3'}}</td>
  
                                <!-- <td *ngIf="item.ID === editItemID"><input type="text"
                                    class="form-control w-100 {{item.lengthDisableClass}}" [(ngModel)]="item.LENGTH"
                                    [ngModelOptions]="{standalone: true}" [readonly]="item.lengthReadOnly"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)"
                                  style="text-align: right;">
                                  {{item.LENGTH}}</td>
  
                                <td *ngIf="item.ID === editItemID"><input type="text"
                                    class="form-control w-100 {{item.widthDisableClass}}" [(ngModel)]="item.WIDTH"
                                    [ngModelOptions]="{standalone: true}" [readonly]="item.widthReadOnly"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)"
                                  style="text-align: right;">
                                  {{item.WIDTH}}</td>
  
                                <td *ngIf="item.ID === editItemID">
                                  <input (keyup)="searchEditRmTypeDesc($event.target.value, item)" name="itemid"
                                    [(ngModel)]='item.rmtypedesc' [ngModelOptions]="{standalone: true}"
                                    [value]="item.rmtypedesc || ''" autocomplete="off"
                                    class="w-100 form-control error-border form-control-sm {{item.readonlyRMTypeClass}}"
                                    [readonly]="item.readonlyRMType">
                                  <div *ngIf="searchEditRMDesc != ''" class="search-list-header" style="right: 0;">
  
                                    <table id="selectedValue" class="table table-condensed table-striped table-hover">
                                      <tr class="ui-menu-item" role="menuitem">
                                        <th>{{'itemname' | translate}}</th>
                                        <th>{{'oldcode' | translate}}</th>
                                        <th>{{'itemcode' | translate}}</th>
                                      </tr>
                                      <tr class="ui-menu-item" role="menuitem" *ngFor="let result of rmtypeList"
                                        (click)="onChangeRMType(result, item)">
                                        <td>{{ result.ITEMNAME }}</td>
                                        <td>{{ result.oldcode }}</td>
                                        <td>{{ result.ITEMCODE }}</td>
                                      </tr>
                                    </table>
                                  </div>
                                </td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)">{{item.rmtypedesc}}</td>
  
                                <td *ngIf="item.ID === editItemID"><input type="text" class="form-control w-100"
                                    [(ngModel)]='item.COMPONENTWT' [ngModelOptions]="{standalone: true}"
                                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');"
                                    style="text-align: right;"></td>
                                <td *ngIf="item.ID !== editItemID" (dblclick)="editItem(item.ID)"
                                  style="text-align: right;">
                                  {{item.COMPONENTWT | number : '1.3-3'}}</td> -->
  
                                <td style="width:60px;text-align: center;">
                                  <div>
                                    <i *ngIf="item.ID === editItemID" class="fas fa-check customIcon {{canEditCommonClass}}"
                                      (click)="updateItem(item)"></i>
                                    <i *ngIf="item.ID !== editItemID" class="fas fa-edit customIcon {{canEditCommonClass}}"
                                      (click)="editItem(item.ID)"></i>
                                    <i style="margin-left: 5px;" class="far fa-trash-alt customIcon {{canDeleteCommonClass}}"
                                      (click)="removeItem(i)"></i>
                                  </div>
                                </td>
                              </tr>
  
                             
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button class="btn btn-sm btn-secondary rounded bg-danger" [routerLink]="'/bom-preparation'">{{'cancel' | translate}}</button>
                  <button *ngIf="action == 'new'" type="button" [disabled]="isLoadingResults" class="btn btn-sm btn-info rounded {{canCreateCommonClass}}" (click)="validateBeforeSave(newData, 'Insert')">{{'save' | translate}}</button>
                  <button *ngIf="action == 'edit'" type="button" [disabled]="isLoadingResults" class="btn btn-sm btn-info rounded {{canEditCommonClass}}" (click)="validateBeforeSave(newData, 'Update')">{{'update' | translate}}</button>
                </div>
              </div>
            </div>
          </div>
        </form>
  
        <!-- <div *ngIf="userRightCheck.canview == 'False'" class="row">
          <div class="col-md-12">
              <div class="card">
                  <div class="card-body">
                      {{'youhavenotpermission' | translate}}
                  </div>
              </div>
          </div>
      </div> -->
        <app-footer></app-footer>
      </div>
    </div>
  </div>