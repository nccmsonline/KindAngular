<div class="preloader" style="display: none;">
    <div class="lds-ripple">
      <div class="lds-pos"></div>
      <div class="lds-pos"></div>
    </div>
  </div>
  <div id="main-wrapper" data-theme="light" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
    data-sidebar-position="fixed" data-header-position="fixed" data-boxed-layout="full">
    <app-header></app-header>
    <app-sidebar></app-sidebar>
  
    <div class="page-wrapper">
      <div class="container-fluid" style="background:#dcdcdc;">
        <div class="row" id="statementofacfirstpage">
          <div class="col-md-12">
            <div class="card" style="border-top: 2px solid #0e43af;box-shadow:0 1px 3px rgba(0,0,0,.3);">
              <div class="card-body border-bottom py-2 m-b-2">
                <div class="d-md-flex align-items-center">
                  <div class="form-row mx-0 d-flex bd-highlight w-100">
                    <h4 class="card-title m-0">{{'machinehistory' | translate}}</h4>
                  </div>
                </div>
              </div>
  
              <div class="row">
                <div class="form-group col-md-4 mb-1 ml-3 ">
                  <label>{{'selectmachine'| translate}}</label>&nbsp;<span></span>
                  <ng-select class="custom-machine-history-class ngx-custom-select-dropdown-text-wrap custom-material-ng-container"
                    [(ngModel)]="newData.machineid" [ngModelOptions]="{standalone: true}" (change)="reportchange($event,newData)" style="width: 100% !important;"
                    name="machineid" [virtualScroll]="true" [items]="DataGet" bindLabel="MACHINENAME" bindValue="MACHINEID"
                    placeholder="Select Machine">
                    <ng-template ng-header-tmp class="ng-template-oa-class">
                        <table > 
                            <tr>
                              <th style="width:300px"> {{'machine' | translate}} </th>
                              <th style="width: 120px;"> {{'srno' | translate}} </th>
                              <th style="width: 280px;"> {{'location' | translate}} </th>
                            </tr>
                            <ng-template ng-option-tmp let-item="item">
                                <tr>
                                  <td style="width:300px"> {{item.MACHINENAME}} </td>
                                  <td style="width: 120px;"> {{item.MACHINESERIALNO }} </td>
                                  <td style="width: 280px;"> {{item.LOCATION }} </td>
                                </tr>
                            </ng-template>
                        </table>
                    </ng-template>
                  </ng-select>
                </div>
  
                <div class="form-group col-md-2 mb-2">
                  <label>From Date</label>&nbsp;<span></span>
                  <mat-form-field class="form-control py-1 mat-form-field-date-picker" style="width: 150px;">
                    <input matInput [matDatepicker]="picker" [max]="fyenddate" [(ngModel)]="newData.fromdate"
                      [ngModelOptions]="{standalone: true}" readonly (dateChange)="getMachineData()">
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                  </mat-form-field>
                </div>
  
                <div class="form-group col-md-2 mb-2">
                  <label>To Date</label>&nbsp;<span></span>
                  <mat-form-field class="form-control py-1 mat-form-field-date-picker" style="width: 150px;">
                    <input matInput [matDatepicker]="picker1" [max]="fyenddate" [(ngModel)]="newData.todate"
                      [ngModelOptions]="{standalone: true}" readonly (dateChange)="getMachineData()">
                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                    <mat-datepicker #picker1></mat-datepicker>
                  </mat-form-field>
                </div>
  
                <div class="form-group col-md-2 mb-2">
                  <label>{{'type' | translate}}</label>&nbsp;<span></span>
                  <ngx-select class="ngx-custom-select-dropdown ngx-custom-select-dropdown-text-wrap hsn-ngx-custom-class w-100"
                    [allowClear]="true" [(ngModel)]="newData.mttype" [items]="mtfilterArray" (select)="getMachineData()"
                    optionValueField="id" optionTextField="name" [ngModelOptions]="{standalone: true}" (remove)="getMachineData()">
                  </ngx-select>
                </div>
  
                <!-- <div *ngIf="showdetailReport" class="form-group col-md-1 mb-2">
                  <label></label>&nbsp;<span></span>
                  <button [disabled]="isLoadingResults" class="btn btn-sm rounded btn-info waves-effect waves-light"
                  (click)="getdataonClick(newData)">{{'detailedreport' | translate}}</button>
                </div> -->
  
              </div>
  
              <div class="row">
                <div class="card-body border-top supplier-master">
                  <div class="row- ">
                    <div class="form-row mx-0">
  
                      <div class="form-group mr-2 col-md-4 mb-2">
                        <label for="inputEmail4">{{'location'| translate}}</label>
                        <input type="text" class="form-control form-control-sm search-box readonly-disable"
                          [(ngModel)]="newData.location" [ngModelOptions]="{standalone: true}" readonly>
                      </div>
                      <div class="form-group mr-2 col-md-2 mb-2">
                        <label for="inputEmail4">{{'lastpmdone'| translate}}</label>
                        <input type="text" class="form-control form-control-sm search-box readonly-disable"
                          [(ngModel)]="newData.LASTMAINT" [ngModelOptions]="{standalone: true}" readonly>
                      </div>
  
                      <div class="form-group mr-2 col-md-2 mb-2">
                        <label for="inputEmail4">{{'nextpmdue'| translate}}</label>
                        <input type="text" class="form-control form-control-sm search-box readonly-disable"
                          [(ngModel)]="newData.NEXTMAINT" [ngModelOptions]="{standalone: true}" readonly>
                      </div>
                      <div class="form-group mr-2 col-md-2 mb-2">
                        <label for="inputEmail4">{{'lastbdown'| translate}}</label>
                        <input type="text" class="form-control form-control-sm search-box readonly-disable"
                          [(ngModel)]="newData.LASTBDOWNMAINT" [ngModelOptions]="{standalone: true}" readonly>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
  
              <div class="col-md-12">
                <div class="d-flex justify-content-between align-items-stretch w-100 boxed-layout">
                  <div class="w-100">
                    <div class="example-loading-shade" *ngIf="isLoadingResults">
                      <mat-spinner [diameter]="40" *ngIf="isLoadingResults"></mat-spinner>
                    </div>
                    <div *ngIf="showitem == true">
                      <table class="table table-sm table-striped table-custom custom-table-main w-100 m-b-0"
                        id="contentToConvert">
                        <thead>
                          <tr style="background-color: rgb(148, 195, 250)">
                            <th scope="col" style="text-align : center;width: 4%;">{{'mtno' | translate}}</th>
                            <th scope="col" style="width: 8%;">{{'mtdate' | translate}}</th>
                            <th scope="col" style="width: 4%;text-align: center;">{{'mono' | translate}}</th>
                            <th scope="col" style="width: 8%;">{{'dept' | translate}}</th>
                            <th scope="col" style="width: 4%;">{{'type' | translate}}</th>
                            <th scope="col" style="width: 13%;">{{'problem' | translate}}</th>
                            <th scope="col" style="width: 13%;"><a>{{'rootcause' | translate}}</a></th>
                            <th scope="col" style="width: 6%;"><a>{{'mtstatus' | translate}}</a></th>
                            <th scope="col" style="width: 6%;text-align: right"><a>{{'prdnhrslost' | translate}}</a></th>
                            <th scope="col" style="width: 8%;text-align: right;"><a>{{'labouramt' | translate}}</a></th>
                            <th scope="col" style="width: 8%;text-align: right;"><a>{{'partsamt' | translate}}</a></th>
                            <th scope="col" style="width: 8%;text-align: right;"><a>{{'outsidelabouramt' | translate}}</a> </th>
                            <th scope="col" style="width: 10%; text-align: right;"><a>{{'total' | translate}}</a></th>
                          </tr>
                        </thead>
                        <tbody class="font-sm bg-light">
                          <tr *ngFor="let data of reportData">
                            <td style="width: 4%; text-align : center;" scope="row"><a
                                [routerLink]="['/add-maintenance-ticket/'+data.ID+'/mchistory']">{{data.MTNO}}</a> </td>
                            <td style="width: 8%; text-align : left;">{{data.MTDATE | date:'dd/MMM/yyyy'}}</td>
                            <td style="width: 4%; text-align : center;" scope="row"><a
                                [routerLink]="['/add-maintenance-order/'+data.ID+'/mchistory']">{{data.MONO}}</a></td>
                            <td style="width: 8%;text-align  : left;">{{data.DEPTNAME }}</td>
                            <td style="width: 4%;text-align  : left;">{{data.TYPE }}</td>
                            <td style="width: 13%;text-align : left;"  matTooltip="{{data.mtproblem}}"><span class="limittext">{{data.MTPROBLEM}} </span></td>
                            <td style="width: 13%;text-align : left;"  matTooltip="{{data.rootcause}}"><span class="limittext"> {{data.ROOTCAUSE}} </span></td>
                            <td style="width: 6%;text-align : left;">{{data.MOSTATUS }}</td>
                            <td style="width: 6%;text-align : right;">{{data.HOURSLOST}}</td>
                            <td style="width: 8%; text-align : right;">{{data.MOLBR | number:'1.2-2'}}</td>
                            <td style="width: 8%; text-align : right;">{{data.MOPARTS | number:'1.2-2'}}</td>
                            <td style="width: 8%; text-align : right;">{{data.MOOUTSIDELBR | number:'1.2-2'}}</td>
                            <td style="width: 10%; text-align : right;">{{data.TOTALAMT | number:'1.2-2'}}</td>
                          </tr>
                          <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td style="text-align: left;" scope="row"><strong>{{'total' | translate}} :</strong></td>
                            <td style="text-align: right;" scope="row"><strong>{{hrsTotal}}</strong> </td>
                            <td style="text-align: right;" scope="row"><strong>{{molbrTotal | number:'1.2-2'}}</strong>  </td>
                            <td style="text-align: right;" scope="row"><strong>{{mopartsTotal | number:'1.2-2'}}</strong> </td>
                            <td style="text-align: right;" scope="row"> <strong>{{mooutsidelbrTotal | number:'1.2-2'}}</strong></td>
                            <td style="text-align: right;" scope="row"><strong>{{grandTotal | number:'1.2-2'}}</strong></td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <!-- </kendo-pdf-export> -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>