<div class="preloader" style="display: none;">
    <div class="lds-ripple">
      <div class="lds-pos"></div>
      <div class="lds-pos"></div>
    </div>
  </div>
  
  <div id="main-wrapper" data-theme="light" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
    data-sidebar-position="fixed" data-header-position="fixed" data-boxed-layout="full">
    <app-header></app-header>
    <app-sidebar></app-sidebar>
    <div class="page-wrapper">
      <div class="container-fluid" style="background:#dcdcdc;">
        <div class="example-loading-shade" *ngIf="isLoadingResults ">
          <mat-spinner [diameter]="40" *ngIf="isLoadingResults"></mat-spinner>
        </div>
        <form  [formGroup]="generateLetterform" novalidate>
        <div class="card" style="border-top: 2px solid #0e43af;box-shadow:0 1px 3px rgba(0,0,0,.3);" (click)="dropdownHide()">
          <div class="card-body py-2 mb-2">
            <div class="d-md-flex align-items-center">
              <div class="form-row mx-0 d-flex bd-highlight w-100">
                <div class="form-group row col-md-6 mb-2">
                  <a class="btn btn-sm rounded btn-warning mr-3" [routerLink]="['/generate-letter']"
                    title="{{'back' | translate}}"><i class="mdi mdi-keyboard-backspace"></i></a>
                  <h4 class="card-title m-0">{{'generateletter' | translate}}</h4>
                </div>
              </div>
            </div>
          </div>
          <notifier-container></notifier-container>
  
          <div *ngIf="summary == false">
            <p-steps [model]="items" [(activeIndex)]="activeIndex"></p-steps>
  
            <!-- 1 Step -->
            <div *ngIf="activeIndex == 0">
              <div class="col-md-12 d-flex">
                <h4>{{'step' | translate}} 1: {{'general' | translate}}</h4>
  
                <mat-radio-group name="gender" [(ngModel)]="newData.lettertype" [ngModelOptions]="{standalone: true}" (change)="letterChange()" class="ml-5" >
                  <mat-radio-button value="1">{{'employeerelatedletter' | translate}}</mat-radio-button>
                  <mat-radio-button class="ml-3" value="2">{{'generalletter' | translate}}</mat-radio-button>
                  <mat-radio-button class="ml-3" value="3">{{'resumerelated' | translate}}</mat-radio-button>
                </mat-radio-group>
              </div>
              <div class="col-md-12 tab-content m-t-10" id="pills-tabContent">
                <div class="card-body indent-entry px-0 py-2">
                  <div class="form-inline">
                      <div class="form-group col-md-6 mb-2">
                        <label class="col-md-4 text-left error-control-label required">{{'documentcategory' | translate}}</label>
                        <div class="col-md-6 d-flex">
                          <ngx-select class="ngx-custom-select-dropdown" [ngModelOptions]="{standalone: true}"
                            name="documenttype" [allowClear]="true" [(ngModel)]="newData.documenttype"
                            [items]="documentCategory" optionValueField="ID" optionTextField="DOCTYPE" (remove)="documentCategoryClose('click')"
                            placeholder="{{'pleaseselect' | translate}}" (select)="documentCategoryChange($event, 'click')">
                          </ngx-select>
                        </div>
                      </div>
  
                      <div class="form-group col-md-6 mb-2">
                        <label class="col-md-4 text-left error-control-label required">{{'department' | translate}}</label>
                        <div class="col-md-6 d-flex">
                          <ngx-select class="ngx-custom-select-dropdown" [ngModelOptions]="{standalone: true}"
                            name="deptid" [allowClear]="true" [(ngModel)]="newData.deptid" (remove)="departmentClose('click')"
                            [items]="departmentDataget" optionValueField="ID" optionTextField="NAME"
                            placeholder="{{'pleaseselect' | translate}}" (select)="departmentChange($event, 'click')">
                          </ngx-select>
                        </div>
                      </div>
  
                      <div class="form-group col-md-6 mb-2">
                        <label class="col-md-4 text-left error-control-label required">{{'subject' | translate}}</label>
                        <div class="col-md-6 d-flex">
                          <ngx-select class="ngx-custom-select-dropdown" [ngModelOptions]="{standalone: true}"
                            name="subjectid" [allowClear]="true" [(ngModel)]="newData.subjectid" (remove)="subjectClose('click')"
                            [items]="subjectDataget" optionValueField="ID" optionTextField="NAME"
                            placeholder="{{'pleaseselect' | translate}}" (select)="subjectChange($event, 'click')">
                          </ngx-select>
                        </div>
                      </div>
  
                      <div class="form-group col-md-6 mb-2">
                        <label class="col-md-4 text-left error-control-label required">{{'title' | translate}}</label>
                        <div class="col-md-6 d-flex">
                          <ngx-select class="ngx-custom-select-dropdown" [ngModelOptions]="{standalone: true}"
                            name="titleid" [allowClear]="true" [(ngModel)]="newData.titleid" (remove)="titleClose('click')"
                            [items]="titleDataget" optionValueField="ID" optionTextField="NAME"
                            placeholder="{{'pleaseselect' | translate}}" (select)="titleChange($event, 'click')">
                          </ngx-select>
                        </div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
  
            <!-- 2 Step -->
            <div *ngIf="activeIndex == 1">
              <div class="col-md-12">
                <h4>{{'step' | translate}} 2: {{'selectemployees' | translate}}</h4>
              </div>
              <div class="col-md-12 tab-content m-t-10" id="pills-tabContent">
                <div class="card-body indent-entry px-0 py-2">
                  <div class="form-inline">
                      <div class="form-group col-md-12 mb-2">
                        <label class="col-md-2 text-left">{{'generatefor' | translate}}</label>
                        <div class="col-md-10 d-flex">
                          <mat-radio-group class="mat-radio-label d-flex align-items-center" [(ngModel)]="newData.emptype" (change)="singleMultiChange()" [ngModelOptions]="{standalone: true}">
                            <mat-radio-button class="example-margin h6" value="s" checked> {{'singleemployee' |translate}} </mat-radio-button>
                            <mat-radio-button class="example-margin h6 mx-3" value="m"> {{'multipleemployee' |translate}} </mat-radio-button>
                          </mat-radio-group>
                        </div>
                      </div>
  
                      <div class="form-group col-md-12 mb-2">
                        <label class="col-md-2 text-left error-control-label required">{{'employee' | translate}}</label>
  
                        <!-- Single Employee -->
                        <div *ngIf="newData.emptype == 's'" class="col-md-10 d-flex">
                          <!-- Empty Select Employee -->
                          <div class="es-display empName hide" [ngStyle]="{'display': emptyEmpDisplay}">
                            <div class="d-flex align-items-center">
                              <img *ngIf="empListToshow.length == 0" class="es-employee-photo img_left pull-left mr-2" src="assets/images/users/default.png" height="30" width="30">
                              <img *ngIf="empListToshow.length !== 0" class="es-employee-photo img_left pull-left mr-2" height="30" width="30" src="assets/images/users/default.png">
  
                              <div class="pull-left es-display-name">
                                <h4 class="custom-h4-class">
                                  <span *ngIf="empListToshow.length == 0" class="es-employee-display" (click)="clickEmptyRow()">{{'selectanemployee...' | translate}}</span>
                                  <span *ngIf="empListToshow.length !== 0" class="es-employee-display" (click)="clickEmptyRow()">{{newData.NAME}}</span>
                                </h4>
                                <span class="empNo es-employee-no"></span>
                              </div>
  
                              <div class="pull-left es-button search" (click)="clickEmptyRow()">
                                <button class="btn btn-mini">
                                  <i class="fas fa-search es-icon-search"></i> {{'search' | translate}}
                                </button>
                              </div>
  
                              <div *ngIf="empListToshow.length !== 0" class="pull-left es-button search">
                                <button class="btn btn-mini" (click)="clearEmpdata()">
                                  <i class="far fa-window-close"></i> {{'clear'| translate}}
                                </button>
                              </div>
                            </div>
                          </div>
  
                          <!-- Search Employee -->
                          <div class="ui-g-12 ui-md-4" [ngStyle]="{'display': selectedEmpDisplay}">
                            <div class="ui-inputgroup ui-custom-generate-l">
                                <!-- <span class="ui-inputgroup-addon p-0" (click)="dropdownEmp()"> -->
                                  <!-- <i class="fas fa-angle-down"></i> -->
                                  <!-- <select class='form-control p-0 custom-select-hover' [(ngModel)]="newData.empSelect" [ngModelOptions]="{standalone: true}" (change)="changeEmployeeMstr($event)" [ngStyle]="{'background': empBgDD, 'width': '22px'}">
                                    <option value="C" style="background: #ffffff;">{{'currentemployee' | translate}}</option>
                                    <option value="R" style="background: #ffffff;">{{'resignedemployee'| translate}}</option>
                                    <option value="A" style="background: #ffffff;">{{'allemployees'| translate}} </option>
                                  </select> -->
                                <!-- </span> -->
                                <!-- <input #employeeFocus [(ngModel)]="newData.NAME" [ngModelOptions]="{standalone: true}" class="form-control form-control-sm" placeholder="{{'employeename' | translate}}">    -->
  
                                <input #employeeFocus [(ngModel)]='newData.NAME' [ngModelOptions]="{standalone: true}" (keyup)="searchEmpName($event.target.value, newData)" autocomplete="off" class="w-100 form-control error-border form-control-sm" style="height: 35px;">
                                <div *ngIf="arrayResumeName != ''" class="search-list">
                                  <div class="example-loading-shade" *ngIf="isLoading">
                                    <mat-spinner  [diameter]="20" *ngIf="isLoading"></mat-spinner>
                                  </div>
                                  <ul id="selectedValue" class="custom-customer-order-list">
                                    <li class="ui-menu-item" role="menuitem" *ngFor="let result of namelistget"
                                      (click)="onChangeOfEmpName(result, newData)">
                                      <a> {{ result.NAME }} </a>
                                    </li>
                                  </ul>
                                </div>
  
                                <span class="ui-inputgroup-addon custom-span-close-hover" (click)="closeEmptyRow()" [ngStyle]="{'background': empBgDD}">
                                  <i class="far fa-window-close"></i>
                                </span>      
                            </div>
                          </div>
                        </div>
  
                        <!-- Multiple Employee -->
                        <!-- <div *ngIf="newData.emptype == 'm'" class="col-md-10 row">
                          <div class="ui-g-12 ui-md-4">
                            <ngx-select class="ngx-custom-select-dropdown" [ngModelOptions]="{standalone: true}"
                              name="titleid" [allowClear]="true" [(ngModel)]="newData.titleid"
                              [items]="titleDataget" optionValueField="id" optionTextField="title"
                              placeholder="{{'selecttitle' | translate}}">
                            </ngx-select>
                          </div>
                        </div> -->
                      </div>
                  </div>
  
  
                  <mat-form-field *ngIf="newData.emptype == 'm'">
                    <input matInput 
                    (keyup)="searchEmpName($event.target.value, newData)" placeholder="{{'searchbyemployeenameorno' | translate}}">
                  </mat-form-field>
                  <div class="example-container mat-elevation-z8" *ngIf="newData.emptype == 'm'">
                    <table mat-table [dataSource]="multipledataSource" class="mat-elevation-z8 custom-letter-thead">
  
                      <!-- Checkbox Column -->
                      <ng-container matColumnDef="select">
                          <th mat-header-cell *matHeaderCellDef class="th-custom-class">
                            <mat-checkbox [(ngModel)]="checked" [ngModelOptions]="{standalone: true}"
                              (change)="SelectAllCheckbox($event)"></mat-checkbox>
                          </th>
                          <td mat-cell *matCellDef="let element" class="td-custom-class">
                            <mat-checkbox [(ngModel)]="element.checked" [ngModelOptions]="{standalone: true}"
                              (change)="onChangeCheckbox($event, element)"></mat-checkbox>
                          </td>
                        <!-- <th mat-header-cell *matHeaderCellDef class="th-custom-class">
                          
                        </th> -->
                        <!-- <td mat-cell *matCellDef="let row" class="td-custom-class">
                          
                        </td> -->
                      </ng-container>
                    
                      <!-- Position Column -->
                      <ng-container matColumnDef="#">
                        <th mat-header-cell *matHeaderCellDef class="th-custom-class"> # </th>
                        <td mat-cell *matCellDef="let element; let i = index;" class="td-custom-class"> {{i+1}} </td>
                      </ng-container>
                    
                      <!-- Name Column -->
                      <ng-container matColumnDef="empno">
                        <th mat-header-cell *matHeaderCellDef class="th-custom-class"> {{'employeeno' | translate}}. </th>
                        <td mat-cell *matCellDef="let element" class="td-custom-class"> {{element.EMPID}} </td>
                      </ng-container>
                    
                      <!-- Weight Column -->
                      <ng-container matColumnDef="empname">
                        <th mat-header-cell *matHeaderCellDef class="th-custom-class"> {{'employeename' | translate}} </th>
                        <td mat-cell *matCellDef="let element" class="td-custom-class"> {{element.NAME}} </td>
                      </ng-container>
                    
                      <tr mat-header-row *matHeaderRowDef="multidisplayedColumns"></tr>
                      <tr mat-row *matRowDef="let row; columns: multidisplayedColumns;" [ngStyle]="{'background': row.colorcode}"></tr>
                    </table>
                  </div>
              
                </div>
              </div>
            </div>
  
            <!-- Step 3 -->
            <div *ngIf="activeIndex == 2">
              <div class="col-md-11">
                
                <h4>{{'step' | translate}} 3: {{'preview' | translate}}</h4>
              </div>
  
              <div class="col-md-11">
                <p-table [value]="multiPreviewLetterArray" [rows]="1" [paginator]="true" [responsive]="true" autoLayout ="true" class="custom-ptable-punjab-class-div">
                  <ng-template pTemplate="body" let-notworkingArr>
                    <tr>
                      <td [innerHTML]="notworkingArr.DOCUMENTTEXT | safeHtml"></td>
                    </tr>
                  </ng-template>
                </p-table>
              </div>
  
              <!-- <div *ngFor="let data of multiPreviewLetterArray" class="col-md-12 tab-content m-t-10" id="pills-tabContent">
                <div class="card-body indent-entry px-0 py-2">
                  <div class="form-inline">
                    <div [innerHTML]="data.documenttext"></div>
                  </div>
                </div>
              </div> -->
              <!-- <p-paginator [rows]="1" [totalRecords]="2"></p-paginator> -->
            </div>
  
            <!-- Preview Next Finish Cancel Button-->
            <div class="preview-next">
              <button type="submit" class="btn btn-sm btn-info rounded" [disabled]='previewDisable' (click)="previewClick(activeIndex)"><i class="fas fa-arrow-left mr-1"></i>{{'previous'|translate}}</button>
              <button type="submit" class="btn btn-sm btn-info rounded m-1" [disabled]='nextDisable' (click)="validatenext(activeIndex)">{{'next'|translate}}<i class="fas fa-arrow-right ml-1"></i></button>
              <button *ngIf="nextDisable == true" type="submit" class="btn btn-sm btn-info rounded m-1 " (click)="finishValidate()"><i class="fas fa-check mr-1"></i>{{'finish'|translate}}</button>
              <button *ngIf="nextDisable == true" type="submit" class="btn btn-sm btn-secondary rounded bg-danger m-1" [routerLink]="['/generate-letter']">{{'cancel'|translate}}</button>
            </div>
          </div>
  
          <!-- Summary -->
          <div *ngIf="summary == true" class="p-2">
            <div class="col-md-12">
              <h4>{{'generateletter' | translate}}: {{'summary' | translate}}</h4>
            </div>
            <div class="example-container mat-elevation-z8">
              <table mat-table [dataSource]="dataSourceSummary" class="mat-elevation-z8 custom-letter-thead">
                
                <ng-container matColumnDef="select">
                  <th mat-header-cell *matHeaderCellDef class="th-custom-class">
                    <mat-checkbox [(ngModel)]="summarychecked" [ngModelOptions]="{standalone: true}"
                      (change)="SummarySelectAllCheckbox($event)"></mat-checkbox>
                  </th>
                  <td mat-cell *matCellDef="let element" class="td-custom-class">
                    <mat-checkbox [(ngModel)]="element.summarychecked" [ngModelOptions]="{standalone: true}"
                      (change)="SummaryonChangeCheckbox($event, element)"></mat-checkbox>
                  </td>
                </ng-container>
            
                <ng-container matColumnDef="empno">
                  <th mat-header-cell *matHeaderCellDef class="th-custom-class"> {{'employeeno' | translate}}. </th>
                  <td mat-cell *matCellDef="let element" class="td-custom-class"> {{element.EMPNO}} </td>
                </ng-container>
          
                <ng-container matColumnDef="empname">
                  <th mat-header-cell *matHeaderCellDef class="th-custom-class"> {{'employeename' | translate}} </th>
                  <td mat-cell *matCellDef="let element" class="td-custom-class"> {{element.NAME}} </td>
                </ng-container>
  
                <ng-container matColumnDef="download">
                  <th mat-header-cell *matHeaderCellDef class="th-custom-class">{{'download' | translate}}</th>
                  <td mat-cell *matCellDef="let element" class="td-custom-class text-center"> <i class="fas fa-download" (click)="SinglePDFDownload(element)"></i> </td>
                </ng-container>
              
                <tr mat-header-row *matHeaderRowDef="displayedColumnsSummary"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsSummary;"></tr>
              </table>
            </div>
  
            <!-- <div class="col-md-12 mt-5">
              <h4>{{'publishselectedletters' | translate}}</h4>
            </div>
            
            <div class="col-md-12 my-3">
              <mat-checkbox #publish>{{'publishtoemployeeportal' | translate}}</mat-checkbox>
            </div> -->
  
            <div class="preview-next">
              <!-- <button type="submit" class="btn btn-sm btn-info rounded ">{{'download'|translate}}</button> -->
              <!-- <button type="submit" [disabled]='!publish.checked' (click)="publishDataFunction()" class="btn btn-sm btn-info rounded m-1 {{canCreateCommonClass}}">{{'publish'|translate}}</button> -->
              <button type="submit" class="btn btn-sm btn-secondary rounded bg-danger m-1" [routerLink]="['/generate-letter']">{{'close'|translate}}</button>
            </div>
          </div>
        </div>
        </form>
  
    
        <app-footer></app-footer>
      </div>
    </div>
  </div>